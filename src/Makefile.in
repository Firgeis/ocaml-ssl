# Copyright 2003 Samuel Mimram
# libssl bindings for OCaml.
#
# by Samuel Mimram


OCAMLMAKEFILE = OCamlMakefile

OCAMLFIND = @OCAMLFIND@
OCAMLFIND_LDCONF = @OCAMLFIND_LDCONF@
OCAMLC = @OCAMLC@
OCAMLOPT = @OCAMLOPT@
OCAMLBEST = @OCAMLBEST@
OCAMLMKTOP = @OCAMLMKTOP@
OCAMLMKLIB = @OCAMLMKLIB@
OCAMLCP = @OCAMLCP@
OCAMLDEP = @OCAMLDEP@
OCAMLLEX = @OCAMLLEX@
OCAMLYACC = @OCAMLYACC@
OCAMLDOC = @OCAMLDOC@
AR = @AR@
LATEX = @LATEX@
DVIPS = @DVIPS@
PS2PDF = @PS2PDF@
OCAMLLIBPATH = @CAMLLIBPATH@
CC = @CC@
CFLAGS = -Wall @CFLAGS@
CPPFLAGS = @CPPFLAGS@
OCAMLDOCFLAGS = -stars
ANNOTATE = true

SOURCES = ssl_stubs.c ssl.mli ssl.ml ssl_threads.ml
RES_CLIB_SUF = _stubs
RESULT = ssl
LIBINSTALL_FILES = $(wildcard *.mli *.cmi *.cma *.cmxa *.cmx *.a *.so)
OCAMLDOCFLAGS = -stars
ACLIBS = @LIBS@
CLIBS = $(ACLIBS:-l%=%)
LDFLAGS = @LDFLAGS@
LIBDIRS = $(LDFLAGS:-L%=%)
NO_CUSTOM = yes
OCAMLFLAGS = @OCAMLFLAGS@

all: $(OCAMLBEST)

byte: byte-code-library
opt: native-code-library

native-code-library: byte-code-library

install:
	$(OCAMLFIND) install $(OCAMLFIND_INSTFLAGS) $(RESULT) META $(LIBINSTALL_FILES)

uninstall:
	$(OCAMLFIND) remove $(OCAMLFIND_INSTFLAGS) $(RESULT)

update: uninstall install

define PROJ_ssl
  SOURCES = ssl_stubs.c ssl.mli ssl.ml
  RESULT = ssl
  THREADS = no
endef
export PROJ_ssl

define PROJ_sslthreads
  SOURCES = ssl_stubs.c ssl.mli ssl.ml ssl_threads.ml
  RESULT = ssl_threads
  THREADS = yes
endef
export PROJ_sslthreads

export SUBPROJS = ssl sslthreads

-include $(OCAMLMAKEFILE)
